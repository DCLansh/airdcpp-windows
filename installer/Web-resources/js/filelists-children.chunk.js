webpackJsonp([5,9],{61:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="share/v0";t["default"]={MODULE_URL:a,DUPE_PATHS_URL:a+"/find_dupe_paths",GROUPED_ROOTS_GET_URL:a+"/grouped_root_paths",STATS_URL:a+"/stats",REFRESH_URL:a+"/refresh",REFRESH_PATHS_URL:a+"/refresh/paths"}},152:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),r=n(l),o=a(45),i=n(o),s=a(149),d=n(s),u=a(165),c=n(u),f=function(e){var t=e.offlineMessage,a=e.submitHandler;return r["default"].createElement(c["default"],{offlineMessage:t},r["default"].createElement(d["default"],{placeholder:"Enter nick...",submitHandler:a,valueField:"nick",descriptionField:"hub_name",url:i["default"].SEARCH_NICKS_URL}))};t["default"]=f},153:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};Object.defineProperty(t,"__esModule",{value:!0});var o=a(1),i=n(o),s=a(83),d=n(s),u=a(60),c=n(u),f=a(61),m=n(f),p=a(95),h=n(p),y=a(162),_=n(y),v=a(18),E=n(v),g=a(144),w=n(g),P=a(6),D=n(P),b=a(23),N=a(85),S=n(N),R=a(154),T=n(R),C=a(155),M=a(49),O=n(M),H=a(128),I=n(H),L=a(31),k=n(L),U=a(5),x=n(U),F=a(9),A=n(F),j=a(82),G=n(j);a(214);var z=function(e){var t=e.active,a=e.list,n=e.title,l=e.onClick;return i["default"].createElement("a",{className:"item "+(t?"active":""),onClick:l},n,a?i["default"].createElement("div",{className:"ui small right label"}," ",a.length," "):null)},W=function(e){var t=e.menuItems,a=e.section;return i["default"].createElement("div",{className:"ui grid normal layout"},i["default"].createElement("div",{className:"four wide column"},i["default"].createElement("div",{className:"ui vertical fluid tabular menu"},t)),i["default"].createElement("div",{className:"twelve wide stretched column"},i["default"].createElement("div",{className:"ui segment main-content"},a.component)))},q=function(e){var t=e.menuItems,a=e.section;return i["default"].createElement("div",{className:"mobile layout"},i["default"].createElement(G["default"],{className:"selection fluid",caption:a.name},t),i["default"].createElement("div",{className:"ui segment main-content"},a.component))},K=i["default"].createClass({displayName:"DownloadDialog",mixins:[b.RouteContext,S["default"]],propTypes:{downloadHandler:i["default"].PropTypes.func,itemInfo:i["default"].PropTypes.shape({path:i["default"].PropTypes.string,dupe:i["default"].PropTypes.number,name:i["default"].PropTypes.string,type:i["default"].PropTypes.object})},getInitialState:function(){return{active:"history",share_paths:[],dupe_paths:[],favorite_paths:[],history_paths:[]}},fetchPaths:function(e,t){var a=this;D["default"].get(e).then(function(e){return a.setState(l({},t,e))})["catch"](function(t){return console.error("Failed to fetch paths",e,t.message)})},fetchDupePaths:function(e){var t=this,a=this.props.itemInfo,n={};I["default"].isDirectory(a.path)?n.path=a.path:n.tth=a.tth,D["default"].post(e,n).then(function(e){return t.setState({dupe_paths:t.state.dupe_paths.concat(e.map(function(e){return I["default"].getParentPath(e,I["default"])}))})})["catch"](function(t){return console.error("Failed to fetch dupe paths",e,t.message)})},componentDidMount:function(){this.fetchPaths(m["default"].GROUPED_ROOTS_GET_URL,"share_paths"),this.fetchPaths(_["default"].DIRECTORIES_URL,"favorite_paths"),this.fetchPaths(h["default"].ITEMS_URL+"/"+p.HistoryEnum.DOWNLOAD_DIR,"history_paths");var e=this.props.itemInfo,t=O["default"].dupeToStringType(e.dupe);t.indexOf("queue")>-1&&this.fetchDupePaths(c["default"].DUPE_PATHS_URL),t.indexOf("share")>-1&&this.fetchDupePaths(m["default"].DUPE_PATHS_URL)},handleDownload:function(e){this.props.downloadHandler({target_name:this.props.itemInfo.name,target_directory:e,target_type:0,priority:u.PriorityEnum.DEFAULT}),w["default"].add(p.HistoryEnum.DOWNLOAD_DIR,e),this.refs.modal.hide()},getMenuItem:function(e){var t=this;return i["default"].createElement(z,{key:e.key,title:e.name,onClick:function(){return t.setState({active:e.key})},active:this.state.active===e.key,list:e.list})},render:function(){var e=this,t=[{name:"Previous",key:"history",list:this.state.history_paths,component:i["default"].createElement(C.PathList,{paths:this.state.history_paths,downloadHandler:this.handleDownload})},{name:"Shared",key:"shared",list:this.state.share_paths,component:i["default"].createElement(C.AccordionTargets,{groupedPaths:this.state.share_paths,downloadHandler:this.handleDownload})},{name:"Favorites",key:"favorites",list:this.state.favorite_paths,component:i["default"].createElement(C.AccordionTargets,{groupedPaths:this.state.favorite_paths,downloadHandler:this.handleDownload})},{name:"Dupes",key:"dupes",list:this.state.dupe_paths,component:i["default"].createElement(C.PathList,{paths:this.state.dupe_paths,downloadHandler:this.handleDownload})}];A["default"].hasAccess(x["default"].FILESYSTEM_VIEW)&&t.push({name:"Browse",key:"browse",component:i["default"].createElement(T["default"],{history:this.state.history_paths,downloadHandler:this.handleDownload})});var a=t.find(function(t){return t.key===e.state.active}),n=t.map(this.getMenuItem),l=k["default"].useMobileLayout()?q:W;return i["default"].createElement(d["default"],r({ref:"modal",className:"download-dialog",title:"Download",closable:!0,icon:E["default"].DOWNLOAD,fullHeight:!0},this.props),i["default"].createElement(l,{menuItems:n,section:a}))}});t["default"]=K},154:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),r=n(l),o=a(156),i=n(o),s=r["default"].createClass({displayName:"DownloadFileBrowser",handleDownload:function(e){this.refs.modal.hide()},onDirectoryChanged:function(e){this.setState({currentPath:e})},getInitialState:function(){return{currentPath:this.getInitialPath()}},selectedNameFormatter:function(e,t){var a=this;if(0===t.length)return e;var n=r["default"].createElement("div",{className:"download-handler",onClick:function(){return a.props.downloadHandler(a.state.currentPath)}},r["default"].createElement("i",{className:"green download link icon"}),r["default"].createElement("a",null,e));return n},getInitialPath:function(){var e=this.props.history;return e.length>0?e[e.length-1]:""},render:function(){return r["default"].createElement(i["default"],{initialPath:this.getInitialPath(),selectedNameFormatter:this.selectedNameFormatter,onDirectoryChanged:this.onDirectoryChanged})}});t["default"]=s},155:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AccordionTargets=t.PathList=void 0;var l=a(1),r=n(l),o=a(116),i=n(o),s=a(17),d=n(s),u=function(){return r["default"].createElement(d["default"],{title:"No paths to display"})},c=function(e){var t=e.path,a=e.downloadHandler;return r["default"].createElement("div",{className:"item"},r["default"].createElement("i",{className:"yellow folder icon"}),r["default"].createElement("div",{className:"content"},r["default"].createElement("a",{onClick:function(e){return a(t)}},t)))},f=function(e){var t=e.downloadHandler,a=e.paths;return 0===a.length?r["default"].createElement(u,null):r["default"].createElement("div",{className:"ui relaxed list"},a.map(function(e){return r["default"].createElement(c,{key:e,path:e,downloadHandler:t})}))};f.PropTypes={downloadHandler:r["default"].PropTypes.func.isRequired,paths:r["default"].PropTypes.array.isRequired};var m=r["default"].createClass({displayName:"AccordionTargets",propTypes:{downloadHandler:r["default"].PropTypes.func.isRequired,groupedPaths:r["default"].PropTypes.array.isRequired},formatParent:function(e){return r["default"].createElement("div",{key:e.name},r["default"].createElement("div",{className:"title"},r["default"].createElement("i",{className:"dropdown icon"}),e.name),r["default"].createElement("div",{className:"content"},r["default"].createElement(f,{paths:e.paths,downloadHandler:this.props.downloadHandler})))},render:function(){var e=this.props.groupedPaths;return 0===e.length?r["default"].createElement(u,null):r["default"].createElement(i["default"],{className:"styled download-targets"},this.props.groupedPaths.map(this.formatParent))}});t.PathList=f,t.AccordionTargets=m},162:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="favorite_directories/v0";t["default"]={MODULE_URL:a,DIRECTORIES_URL:a+"/directories"}},179:function(e,t,a){t=e.exports=a(10)(),t.push([e.id,".download-dialog .accordion.download-targets{overflow-y:auto}.download-dialog .main-content,.download-dialog .mobile.layout{display:flex;flex-direction:column}.download-dialog .content>div,.download-dialog .main-content,.download-dialog .ui.grid .column{height:100%}.download-dialog .download-handler{display:flex}",""])},214:[830,179],557:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),r=n(l),o=a(24),i=n(o),s=a(125),d=a(31),u=n(d),c=function(e){var t=e.item;if(u["default"].useMobileLayout())return r["default"].createElement("span",null);var a=t.location.type.str;return a.length>0&&(a=i["default"].formatSize(t.location.size)+" ("+a+")"),r["default"].createElement(s.SessionFooter,null,r["default"].createElement(s.FooterItem,{label:"Directory size",text:a}),r["default"].createElement(s.FooterItem,{label:"Total list size",text:i["default"].formatSize(t.total_size)}))};t["default"]=c},558:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),r=n(l),o=a(152),i=n(o),s=a(171),d=n(s),u=a(67),c=n(u),f=r["default"].createClass({displayName:"Messages",_handleSubmit:function(e,t){c["default"].createSession(this.props.location,t)},render:function(){return r["default"].createElement(d["default"],{title:"Open list",subHeader:"Start browsing a new filelist",icon:"sitemap"},r["default"].createElement(i["default"],{submitHandler:this._handleSubmit,offlineMessage:"You must to be connected to at least one hub in order to download filelists from other users"}))}});t["default"]=f},559:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),r=n(l),o=a(561),i=n(o),s=a(557),d=n(s),u=a(23),c=a(16),f=n(c),m=a(17),p=n(m),h=r["default"].createClass({displayName:"FilelistSession",mixins:[u.RouteContext],render:function(){var e=this.props.item,t=e.user,a=e.location,n=e.state;return"loaded"===n.id&&a?-1!==t.flags.indexOf("offline")?r["default"].createElement(p["default"],{title:"User offline",description:"You will be able to continue browsing when the user comes back online"}):r["default"].createElement("div",{className:"filelist-session"},r["default"].createElement(i["default"],this.props),r["default"].createElement(d["default"],{item:this.props.item})):r["default"].createElement(f["default"],{text:n.str})}});t["default"]=h},561:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(1),r=n(l),o=a(67),i=n(o),s=a(49),d=n(s),u=a(17),c=n(u),f=a(244),m=n(f),p=a(30),h=a(582),y=n(h),_=a(127),v=n(_),E=a(20),g=n(E),w=a(70),P=n(w),D=a(69),b=a(52),N=a(16),S=n(N),R=r["default"].createClass({displayName:"ListBrowser",_rowClassNameGetter:function(e){return d["default"].dupeToStringType(e.dupe)},_handleClickDirectory:function(e){g["default"].pushSidebarData(this.props.location,{directory:e})},componentWillMount:function(){var e=this.props,t=e.item,a=e.location,n=g["default"].getSidebarData(a);n&&n.directory?t.location.path!==n.directory&&this.sendChangeDirectory(n.directory):g["default"].replaceSidebarData(a,{directory:t.location.path},!0)},componentWillReceiveProps:function(e){var t=g["default"].getSidebarData(e.location),a=t.directory;if(a&&e.item.location.path!==a){var n=g["default"].getSidebarData(this.props.location);n&&n.directory!==a?this.sendChangeDirectory(a):g["default"].replaceSidebarData(e.location,{directory:this.props.item.location.path})}},sendChangeDirectory:function(e){i["default"].changeDirectory(this.props.item.user.cid,e)},emptyRowsNodeGetter:function(){var e=this.props.item.location;return 0!==e.type.files||0!==e.type.directories?r["default"].createElement(S["default"],{text:"Updating view"}):e.complete?r["default"].createElement(c["default"],{title:"No content to display",description:"The directory is empty"}):r["default"].createElement(S["default"],{text:"Preparing download"})},onClickDirectory:function(e,t){var a=this;return"directory"===t.type.id?function(){return a._handleClickDirectory(a.props.item.location.path+e+"/")}:void 0},selectedNameFormatter:function(e){return r["default"].createElement(p.DownloadMenu,{caption:e,user:this.props.item.user,itemInfo:this.props.item.location,location:this.props.location,handler:i["default"].download},r["default"].createElement(p.ActionMenu,{itemData:{directory:this.props.item.location,session:this.props.item},location:this.props.location,actions:i["default"],ids:["reloadDirectory"]}))},render:function(){var e=this.props,t=e.item,a=e.location;return r["default"].createElement("div",{className:"filelist-browser"},r["default"].createElement(m["default"],{path:t.location.path,separator:"/",rootPath:"/",itemClickHandler:this._handleClickDirectory,selectedNameFormatter:this.selectedNameFormatter}),r["default"].createElement(P["default"],{emptyRowsNodeGetter:this.emptyRowsNodeGetter,rowClassNameGetter:this._rowClassNameGetter,store:y["default"],entityId:t.id,viewId:t.location.path,sessionStore:v["default"]},r["default"].createElement(b.Column,{name:"Name",width:200,columnKey:"name",cell:r["default"].createElement(D.FileDownloadCell,{clickHandlerGetter:this.onClickDirectory,userGetter:function(e){return t.user},location:a,handler:i["default"].download}),flexGrow:8}),r["default"].createElement(b.Column,{name:"Size",width:60,columnKey:"size",cell:r["default"].createElement(D.SizeCell,null),flexGrow:1}),r["default"].createElement(b.Column,{name:"Last modified",width:80,columnKey:"time",cell:r["default"].createElement(D.DurationCell,null),flexGrow:1})))}});t["default"]=R},582:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(72),r=n(l),o=a(3),i=n(o),s=a(163),d=n(s);t["default"]=i["default"].createStore({_viewName:"filelist_view",_apiUrl:d["default"].SESSION_URL,mixins:[(0,r["default"])("name")]})}});
//# sourceMappingURL=filelists-children.chunk.js.map